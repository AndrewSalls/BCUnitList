export async function parseCategoryFile(file){return fetch(`./assets/unit_data/category/${file}.json`).then(r=>r.json()).then(async j=>{for(const key of Object.keys(j))j[key]=await flattenCategory(j[key]);return j})}export async function parseCategory(file,name){return fetch(`./assets/unit_data/category/${file}.json`).then(r=>r.json()).then(j=>flattenCategory(j[name]))}async function flattenCategory(arr){for(let x=0;x<arr.length;x++)Array.isArray(arr[x])&&(arr[x]=await parseCategory(arr[x][0],arr[x][1]));return arr.flat()}export async function parseAllCategories(){return fetch("./assets/unit_data/category/types.txt").then(t=>t.text()).then(t=>t.split(" ").map(async p=>({[p]:await parseCategoryFile(p)}))).then(pl=>Promise.all(pl)).then(res=>res.reduce((acc,obj)=>{const parsed={...acc,...obj},toParse=Object.keys(window.localStorage).filter(k=>k.startsWith("_cc-"));if(toParse.length>0){parsed.custom={};for(const key of toParse){const data=JSON.parse(window.atob(window.localStorage.getItem(key)));parsed.custom[data.c]=data.v}}return parsed}))}