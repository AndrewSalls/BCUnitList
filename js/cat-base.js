import loadCannonInfo from"./cat-base/base.js";import loadOtherInfo from"./cat-base/other.js";import loadTreasureInfo from"./cat-base/treasure.js";import loadUpgradeInfo from"./cat-base/upgrade.js";import{checkPort,REQUEST_TYPES}from"./communication/iframe-link.js";import createLoadingBar from"./helper/loading.js";function initializeNavButton(button,target){button.addEventListener("click",()=>{button.classList.contains("current")||(document.querySelector("#base-section-nav")?.querySelectorAll("button").forEach(b=>b.classList.remove("current")),button.classList.add("current"),document.querySelectorAll("#tab-list > div").forEach(t=>t.classList.add("hidden")),target.classList.remove("hidden"))})}function loadBaseSettings(loadingBar){document.querySelector("#user-rank").textContent=window.localStorage.getItem("ur")??"11",loadingBar.increment(),loadTreasureInfo(),loadingBar.increment(),loadCannonInfo(),loadingBar.increment(),(async()=>{await loadUpgradeInfo({cgs:await REQUEST_TYPES.GET_CGS(),abilities:await REQUEST_TYPES.GET_ALL_ABILITY()},REQUEST_TYPES.UPDATE_CGS,REQUEST_TYPES.UPDATE_ABILITY),loadingBar.increment()})(),loadOtherInfo(),loadingBar.increment(),loadTabButtons(),loadingBar.increment()}function loadTabButtons(){document.querySelector("#reset-tab").onclick=()=>{const action=document.querySelector("#base-section-nav .current")?.id;switch(action){case"treasure-tab":document.querySelectorAll(".slider-bronze").forEach(s=>{s.value="0",s.dispatchEvent(new Event("change"))}),document.querySelectorAll(".slider-silver").forEach(s=>{s.value="0",s.dispatchEvent(new Event("change"))}),document.querySelectorAll(".slider-gold").forEach(s=>{s.value="0",s.dispatchEvent(new Event("change"))});break;case"cannon-tab":document.querySelectorAll(".base-values input[type='number']").forEach(i=>{i.value=i.min,i.dispatchEvent(new Event("change"))});break;case"upgrades-tab":const cgs=document.querySelector("#the-one-true-cat");cgs.checked=!1,cgs.dispatchEvent(new Event("change")),document.querySelectorAll("#upgrade-selector input[type='number']").forEach(i=>{i.value=i.min,i.dispatchEvent(new Event("change"))})}},document.querySelector("#max-tab").onclick=()=>{const action=document.querySelector("#base-section-nav .current")?.id;switch(action){case"treasure-tab":document.querySelectorAll(".slider-bronze").forEach(s=>{s.value="0",s.dispatchEvent(new Event("change"))}),document.querySelectorAll(".slider-silver").forEach(s=>{s.value="0",s.dispatchEvent(new Event("change"))}),document.querySelectorAll(".slider-gold").forEach(s=>{s.value=s.max,s.dispatchEvent(new Event("change"))});break;case"cannon-tab":document.querySelectorAll(".base-values input[type='number']").forEach(i=>{i.value=i.max,i.dispatchEvent(new Event("change"))});break;case"upgrades-tab":const cgs=document.querySelector("#the-one-true-cat");cgs.checked=!0,cgs.dispatchEvent(new Event("change")),document.querySelectorAll("#upgrade-selector input[type='number']").forEach(i=>{i.value=i.max,i.dispatchEvent(new Event("change"))})}}}window.addEventListener("DOMContentLoaded",()=>{const loadingBar=createLoadingBar(7,()=>{}),tabQuickButtons=document.querySelector("#quick-complete"),defaultTab=document.querySelector("#treasure-tab");initializeNavButton(defaultTab,document.querySelector("#treasure-selector")),defaultTab.addEventListener("click",()=>tabQuickButtons.classList.remove("hidden"));const cannonTab=document.querySelector("#cannon-tab");initializeNavButton(cannonTab,document.querySelector("#cat-base-selector")),cannonTab.addEventListener("click",()=>tabQuickButtons.classList.remove("hidden"));const upgradeTab=document.querySelector("#upgrades-tab");initializeNavButton(upgradeTab,document.querySelector("#upgrade-selector")),upgradeTab.addEventListener("click",()=>tabQuickButtons.classList.remove("hidden"));const otherButton=document.querySelector("#other-tab");initializeNavButton(otherButton,document.querySelector("#other-selector")),otherButton.addEventListener("click",()=>tabQuickButtons.classList.add("hidden")),defaultTab.click(),loadingBar.increment(),window.addEventListener("portLoaded",()=>loadBaseSettings(loadingBar)),checkPort()&&window.dispatchEvent(new CustomEvent("portLoaded"))});